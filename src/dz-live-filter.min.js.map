{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/dz-live-filter.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","factory","option","defaultOption","rootTag","itemTag","categoryTag","controlFormTag","controlTag","delay","animationCallback","itemNode","result","style","display","arguments","undefined","rootList","document","querySelectorAll","Array","from","find","array","value","indexOf","filterCategory","rootEl","console","timeEnd","categoryList","forEach","category","itemList","openCategory","item","form","querySelector","controlList","itemArray","dataset","filter","itemData","JSON","parse","insetData","push","error","doItemsArray","control","onchange","time","classList","remove","add","formDataObj","formData","FormData","window","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","entries","Symbol","iterator","next","done","pair","controlName","controlValue","err","getFilterOption","stringify","log","delayLocal","countOpenItem","listitem","setFinalResultBind","resultArr","this","bind","generalCountCallback","setCountOpenItem","afterFiltrationCallback","compareData","setFinalResult","getPromise","promise","Promise","resolve","reject","formDataObjIndex","Object","keys","setLocalResult","formInnerArrIndex","formInnerLength","localResult","key","isArray","itemInnerArr","formInnerArr","itemInner","includes","compareArr","then","setTimeout","doListFiltering","doRootInit","init","define","amd","_typeof","dzLiveFilter"],"mappings":"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","file":"dz-live-filter.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","\"use strict\";\r\n\r\n/*! dz-live-filter.js v1.4.0 | (c) 2019 @denzakh | https://github.com/denzakh/dz-live-filter */\r\n\r\n(function (root, factory) {\r\n  if (typeof define === 'function' && define.amd) {\r\n    define(factory);\r\n    console.log(\"amd\");\r\n  } else if (typeof exports === 'object') {\r\n    module.exports = factory;\r\n    console.log(\"CommomJS\");\r\n  } else {\r\n    root.dzLiveFilter = factory;\r\n  }\r\n})(this, function(option) {\r\n\r\n\tlet defaultOption = {\r\n\t    rootTag: \".js-shedule\",\r\n\t    itemTag: \".js-shedule-item\",\r\n\t    categoryTag: \".js-shedule-category\",\r\n\t    controlFormTag: \".js-control-form\",\r\n\t    controlTag: \".js-control\",\r\n\t    delay: 0,\r\n\t    animationCallback: function aimationCallback (itemNode, result) {\r\n\t        itemNode.style.display = \"none\";\r\n\t        if (result) {\r\n\t            itemNode.style.display = \"\";\r\n\t        }\r\n\t    }\r\n\t}\r\n\r\n\r\n\t// run\r\n\tfunction init(option = defaultOption) {\r\n\r\n\t\t// SETTING\r\n\r\n\t\t// default action on item after filtering\r\n\t\tlet defaultAimationCallback = function (itemNode, result) {\r\n\t\t\tif (result) {\r\n\t\t\t\titemNode.style.display = \"\";\r\n\t\t\t} else {\r\n\t\t\t\titemNode.style.display = \"none\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// creating a list of forms\r\n\t\tlet rootList = document.querySelectorAll(option.rootTag);\r\n\t\trootList = Array.from(rootList);\r\n\r\n\t\tlet animationCallback = option.animationCallback || defaultAimationCallback;\r\n\t\tlet delay = option.delay || 0;\r\n\t\tlet rootCount = 0;\r\n\r\n\r\n\t\t// INIT\r\n\t\t// init forms\r\n\t\trootList.forEach(function (rootEl) {\r\n\t\t\tdoRootInit(rootEl, option);\r\n\t\t\trootCount = rootCount + 1;\r\n\t\t});\r\n\r\n\t\t// init one form\r\n\t\tfunction doRootInit(rootEl, option) {\r\n\r\n\t\t\t// preparing a list of children\r\n\t\t\tlet form = rootEl.querySelector(option.controlFormTag);\r\n\t\t\tlet itemList = rootEl.querySelectorAll(option.itemTag);\r\n\t\t\titemList = Array.from(itemList);\r\n\t\t\tlet controlList = rootEl.querySelectorAll(option.controlTag);\r\n\t\t\tcontrolList = Array.from(controlList);\r\n\t\t\tlet itemArray = [];\r\n\t\t\tlet itemTotalCount;\r\n\t\t\tlet itemActiveCount;\r\n\r\n\t\t\t// creating an array from the filtered list\r\n\t\t\titemList.forEach(function (item) {\r\n\t\t\t\tdoItemsArray(itemArray, item);\r\n\t\t\t});\r\n\r\n\t\t\t// filtering and initialization of filters\r\n\t\t\tcontrolList.forEach(function (control) {\r\n\t\t\t\tcontrol.onchange = function(e) {\r\n\t\t\t\t\tconsole.time(\"all\");\r\n\t\t\t\t\t// add animation class to root\r\n\t\t\t\t\trootEl.classList.remove(\"filter-was-sorted\");\r\n\t\t\t\t\trootEl.classList.add(\"is-filter-sorting\");\r\n\r\n\t\t\t\t\t// get object with filter settings\r\n\t\t\t\t\tlet formDataObj = getFilterOption(form);\r\n\r\n\t\t\t\t\tif(JSON.stringify(formDataObj) == \"{}\") {\r\n\t\t\t\t\t\t// all items will be shown if no filters are enabled\r\n\t\t\t\t\t\titemArray.forEach(function (item) {\r\n\t\t\t\t\t\t\tanimationCallback(item[0], true);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// show all categories\r\n\t\t\t\t\t\tfilterCategory(rootEl);\r\n\t\t\t\t\t\t// отключаем анимацию\r\n\t\t\t\t\t\trootEl.classList.remove(\"is-filter-sorting\");\r\n\t\t\t\t\t\trootEl.classList.add(\"filter-was-sorted\");\r\n\t\t\t\t\t\tconsole.log(\"открыты все \" + itemArray.length + \" элементов\");\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// if filters are on\r\n\t\t\t\t\t\titemArray.forEach(function (item) {\r\n\t\t\t\t\t\t\tanimationCallback(item[0], false);\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// data filtering (passing an object with list items and filters)\r\n\t\t\t\t\t\tdoListFiltering(itemArray, formDataObj, rootEl);\r\n\r\n\t\t\t\t\t\t// TODO: add sending settings to the server - sendAjax (form, formDataObj);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\r\n\t\t// FILTRATION\r\n\r\n\t\t// creating an array from the filtered list\r\n\t\tfunction doItemsArray(itemArray, item) {\r\n\t\t\tif (item.dataset.filter) {\r\n\t\t\t\tlet itemData = item.dataset.filter;\r\n\t\t\t\titemData = JSON.parse(itemData);\r\n\t\t\t\tlet insetData = [item, itemData];\r\n\t\t\t\titemArray.push(insetData);\r\n\t\t\t} else {\r\n\t\t\t\tconsole.error(item, \"filtering data not found\");\r\n\t\t\t\t// item.style.backgroundColor = \"rgba(255,0,0,0.5)\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// collecting filter states\r\n\t\tfunction getFilterOption(form) {\r\n\t\t\t// collect all fields (name, value) into the formData object\r\n\t\t\tlet formData = new FormData(form);\r\n\t\t\t// the formData object is transformed into a formDataObj object containing properties in the form of arrays\r\n\t\t\tlet formDataObj = {};\r\n\r\n\t\t\t // if the browser does not support it (ie, safari)\r\n\t\t\t // you can connect the polyfil https://www.npmjs.com/package/formdata-polyfill\r\n\t\t\tif( window.FormData === undefined ) {\r\n\t\t\t\tconsole.error(\"The formData object is not supported by your brooser. You need to use the polyfil https://www.npmjs.com/package/formdata-polyfill\");\r\n\t\t\t}\r\n\r\n\t\t\t// iterate the object using the formData.entries () iterator\r\n\t\t\tfor(var pair of formData.entries()) {\r\n\r\n\t\t\t   let controlName = pair[0];\r\n\t\t\t   let controlValue = pair[1];\r\n\t\t\t   if (!formDataObj[controlName]) {\r\n\t\t\t\t\tformDataObj[controlName] = [];\r\n\t\t\t\t}\r\n\t\t\t\tformDataObj[controlName].push(controlValue);\r\n\t\t\t}\r\n\r\n\t\t\treturn formDataObj;\r\n\t\t}\r\n\r\n\t\t// фильтрация данных\r\n\t\tfunction doListFiltering(itemArray, formDataObj, rootEl) {\r\n\r\n\t\t\t// create delay counter\r\n\t\t\tlet delayLocal = delay;\r\n\t\t\t// create a counter open items\r\n\t\t\tlet countOpenItem = 0;\r\n\r\n\t\t\t// iteration of the array with filtered items\r\n\t\t\titemArray.forEach(function (listitem, i) {\r\n\r\n\t\t\t\tlet itemNode = listitem[0]; // list item in HTML\r\n\t\t\t\tlet itemData = listitem[1]; // array of filtering settings for this item\r\n\r\n\t\t\t\tvar setFinalResultBind = setFinalResult.bind(listitem);\r\n\t\t\t\tlistitem.result = false;\r\n\r\n\t\t\t\tfunction generalCountCallback() {\r\n\t\t\t\t\t// if the item is shown, increment the counter\r\n\t\t\t\t\tif (listitem.result) {\r\n\t\t\t\t\t\tcountOpenItem = countOpenItem + 1;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// if the array has been moved, output the total result\r\n\t\t\t\t\tif (i == itemArray.length - 1) {\r\n\t\t\t\t\t\t// console.log(\"open \" + countOpenItem + \" from \" + itemArray.length);\r\n\t\t\t\t\t\tsetCountOpenItem(countOpenItem, rootEl);\r\n\t\t\t\t\t\tif (option.afterFiltrationCallback) {\r\n\t\t\t\t\t\t\toption.afterFiltrationCallback();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// creating an object with settings\r\n\t\t\t\tlet compareData = {\r\n\t\t\t\t\tlistitem: listitem,\r\n\t\t\t\t\tformDataObj: formDataObj, // array of filter settings for all\r\n\t\t\t\t\titemData: itemData, // array of filtering settings for this item\r\n\t\t\t\t\tsetFinalResult: setFinalResultBind, // final count function\r\n\t\t\t\t\titemNode: itemNode, // list item in HTML\r\n\t\t\t\t\tanimationCallback: animationCallback // функция анимации\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// creating promise and starting comparison\r\n\t\t\t\tfunction getPromise() {\r\n\r\n\t\t\t\t\tlet promise = new Promise((resolve, reject) => {\r\n\t\t\t\t\t\tcompareArr(compareData, resolve);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tpromise.then(\r\n\t\t\t\t\t\tresult => {\r\n\t\t\t\t\t\t\tgeneralCountCallback()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// delayed response (for animation)\r\n\t\t\t\tif (delay) {\r\n\t\t\t\t  setTimeout(getPromise, delayLocal);\r\n\t\t\t\t  delayLocal = delayLocal + delay;\r\n\t\t\t\t} else {\r\n\t\t\t\t  getPromise();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\r\n\t\t\t// array comparison function\r\n\t\t\tfunction compareArr(compareData, resolve) {\r\n\t\t\t\tlet listitem = compareData.listitem;\r\n\t\t\t\tlet formDataObj = compareData.formDataObj;\r\n\t\t\t\tlet itemData = compareData.itemData;\r\n\t\t\t\tlet setFinalResult = compareData.setFinalResult;\r\n\t\t\t\tlet itemNode = compareData.itemNode;\r\n\t\t\t\tlet animationCallback = compareData.animationCallback;\r\n\t\t\t\tlet resultArr = []; // results repository\r\n\r\n\t\t\t\t// counting the number of properties in an object\r\n\t\t\t\tlet formDataObjLength = Object.keys(formDataObj).length;\r\n\t\t\t\tlet formDataObjIndex = formDataObjLength;\r\n\r\n\r\n\r\n\t\t\t\t// the function adds the result of the property to the result array\r\n\t\t\t\tfunction setLocalResult(formInnerArrIndex, formInnerLength, localResult) {\r\n\t\t\t\t\t// check if this is the last local loop\r\n\t\t\t\t\t// if true then send the local result of the property to the array of results\r\n\t\t\t\t\tif(formInnerArrIndex + 1 === formInnerLength) {\r\n\t\t\t\t\t\tresultArr.push(localResult);\r\n\t\t\t\t\t\t// we check that formDataObjIndex = 0 (the last property) and then we consider the final result\r\n\t\t\t\t\t\tif(!formDataObjIndex) {\r\n\t\t\t\t\t\t\tresolve(\"result\");\r\n\t\t\t\t\t\t\treturn setFinalResult(resultArr, itemNode, animationCallback);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor(let key in formDataObj) {\r\n\t\t\t\t\t// counting the number of properties in an object\r\n\t\t\t\t\tformDataObjIndex = formDataObjIndex - 1;\r\n\r\n\t\t\t\t\t// iterate the first level of the formDataObj object (filter object)\r\n\t\t\t\t\t// make sure the item has such a property\r\n\t\t\t\t\tif (!itemData[key]) {\r\n\t\t\t\t\t\tconsole.error(\"свойство \" + key + \" не найдено в строке\");\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// if the property is, check it for the type array\r\n\t\t\t\t\t\tif (Array.isArray(itemData[key])) {\r\n\t\t\t\t\t\t\t// console.log(\"  Свойство: \" + key);\r\n\r\n\t\t\t\t\t\t\t// select current properties\r\n\t\t\t\t\t\t\tlet itemInnerArr = itemData[key]; // array item properties\r\n\t\t\t\t\t\t\tlet formInnerArr = formDataObj[key]; // array of filter properties\r\n\t\t\t\t\t\t\tlet localResult = false;\r\n\t\t\t\t\t\t\tlet formInnerLength = formInnerArr.length; // counting values in the property array\r\n\r\n\t\t\t\t\t\t\t// iterating over the filter property values\r\n\t\t\t\t\t\t\tformInnerArr.forEach(function(itemInner, formInnerArrIndex) {\r\n\r\n\t\t\t\t\t\t\t\t// for each we look for a match in the item property array\r\n\t\t\t\t\t\t\t\tif( itemInnerArr.includes(itemInner) )  {\r\n\t\t\t\t\t\t\t\t\t// if at least one value matches, the property is true\r\n\t\t\t\t\t\t\t\t\tlocalResult = true;\r\n\t\t\t\t\t\t\t\t\tsetLocalResult(formInnerArrIndex, formInnerLength, localResult);\r\n\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tsetLocalResult(formInnerArrIndex, formInnerLength, localResult);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.error(\"property \" + key + \" not an array\");\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// final result determination function\r\n\t\t\tfunction setFinalResult(resultArr, itemNode, animationCallback) {\r\n\r\n\t\t\t\t// check for missing properties\r\n\t\t\t\t// if it does not find false in the results array, returns 0\r\n\t\t\t\tfunction findFalseResult() {\r\n\t\t\t\t\treturn ~find(resultArr, false);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// return the final result of the comparison of filters and the item of filtered data\r\n\t\t\t\tif(!findFalseResult())  {\r\n\t\t\t\t\t// item will be shown\r\n\t\t\t\t\tanimationCallback(itemNode, true);\r\n\t\t\t\t\tthis.result = true;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// item will be hidden\r\n\t\t\t\t\tanimationCallback(itemNode, false);\r\n\t\t\t\t\tthis.result = false;\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// changes in root styles after filtering, activation of the message about the absence of found items\r\n\t\t\tfunction setCountOpenItem(countOpenItem, rootEl) {\r\n\r\n\t\t\t\tif (!countOpenItem) {\r\n\t\t\t\t\trootEl.classList.add(\"is-empty-open-item\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\trootEl.classList.remove(\"is-empty-open-item\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\trootEl.classList.remove(\"is-filter-sorting\");\r\n\t\t\t\trootEl.classList.add(\"filter-was-sorted\");\r\n\t\t\t\tfilterCategory(rootEl);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\r\n\t\t// SERVICE FUNCTIONS\r\n\r\n\t\t// array search function\r\n\t\t function find(array, value) {\r\n\t\t\tif ([].indexOf) {\r\n\t\t\t\treturn array.indexOf(value);\r\n\t\t\t} else {\r\n\t\t\t\tfor (var i = 0; i < array.length; i++) {\r\n\t\t\t\t\tif (array[i] === value) return i;\r\n\t\t\t\t}\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// category filtering\r\n\t\tfunction filterCategory(rootEl) {\r\n\r\n\t\t\tconsole.timeEnd(\"all\");\r\n\r\n\t\t\tif(option.categoryTag) {\r\n\r\n\t\t\t\tlet categoryTag = option.categoryTag;\r\n\t\t\t\tlet itemTag = option.itemTag;\r\n\r\n\t\t\t\tlet categoryList = rootEl.querySelectorAll(categoryTag);\r\n\t\t\t\tcategoryList = Array.from(categoryList);\r\n\r\n\t\t\t\tcategoryList.forEach(function(category){\r\n\t\t\t\t\tlet itemList = category.querySelectorAll(itemTag);\r\n\t\t\t\t\titemList = Array.from(itemList);\r\n\r\n\t\t\t\t\tif (itemList.length > 0) {\r\n\r\n\t\t\t\t\t\tlet openCategory = false;\r\n\r\n\t\t\t\t\t\titemList.forEach(function(item){\r\n\t\t\t\t\t\t\tif(item.style.display != \"none\") {\r\n\t\t\t\t\t\t\t\topenCategory = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tif (openCategory) {\r\n\t\t\t\t\t\t\tcategory.style.display = \"\";\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcategory.style.display = \"none\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tinit(option);\r\n});\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"]}